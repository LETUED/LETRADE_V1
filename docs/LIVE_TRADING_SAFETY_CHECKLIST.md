# 🚨 Letrade_v1 실거래 테스트 안전 체크리스트

## ⚠️ 중요 경고
이 문서는 **실제 돈**을 사용한 거래 테스트를 위한 것입니다. 모든 단계를 신중히 검토하고 확인한 후에만 진행하세요.

---

## 📋 사전 준비 체크리스트

### 1. 시스템 검증 ✅
- [ ] **드라이런 테스트 완료**: 8.92시간 연속 테스트 성공 확인
- [ ] **성능 기준 달성**: 평균 레이턴시 1.921ms 확인  
- [ ] **V-Model 4단계 완료**: 모든 테스트 단계 통과 확인
- [ ] **코드 품질 검증**: 리팩토링 및 패턴 적용 완료

### 2. 환경 설정 🔧
- [ ] **API 키 설정**: Binance 실거래 API 키 및 시크릿 준비
- [ ] **텔레그램 봇**: 알림용 텔레그램 봇 토큰 설정
- [ ] **데이터베이스**: 실거래 전용 DB 준비 (`letrade_live_test_db`)
- [ ] **백업 시스템**: 자동 백업 설정 확인
- [ ] **모니터링**: Prometheus/Grafana 대시보드 준비

### 3. 리스크 매개변수 확인 ⚖️
- [ ] **총 자본**: $100 USD 정확히 설정
- [ ] **최대 포지션**: 1% ($1) 이하 제한
- [ ] **일일 손실**: 0.5% ($0.50) 이하 제한  
- [ ] **총 손실 한도**: $5 이하 제한
- [ ] **스톱로스**: 0.5% 설정
- [ ] **레버리지**: 1배 (현물 거래만)

### 4. 안전 장치 확인 🛡️
- [ ] **비상 정지**: 자동 트리거 설정 확인
- [ ] **연속 손실 제한**: 3회 연속 손실 시 자동 정지
- [ ] **거래량 제한**: 일일 최대 10개 거래
- [ ] **승인 시스템**: $1.50 이상 포지션 승인 필요
- [ ] **쿨링 기간**: 손실 후 1시간 대기

---

## 🔑 실행 전 최종 점검

### API 키 보안 검증
```bash
# 1. API 키 권한 확인
# - 현물 거래 권한만 활성화
# - 출금 권한 비활성화
# - IP 제한 설정 (선택사항)

# 2. 테스트넷 비활성화 확인
BINANCE_TESTNET=false
BINANCE_SANDBOX=false
```

### 시스템 상태 확인
```bash
# 1. 데이터베이스 연결 테스트
python -c "from src.common.database import db_manager; db_manager.connect(); print('DB OK' if db_manager.is_connected() else 'DB FAIL')"

# 2. API 연결 테스트
python scripts/test_binance_connection.py

# 3. 텔레그램 봇 테스트
python scripts/test_telegram_bot.py
```

### 잔고 확인
```bash
# Binance 계정 잔고 확인
# - USDT 잔고: 최소 $110 (수수료 여유분 포함)
# - 기타 자산: 테스트에 영향 없도록 정리
```

---

## 🚀 실행 단계

### 1단계: 환경 준비
```bash
cd /Users/jeondonghwan/Letrade_v1

# 환경 변수 로드
source .env.live_test

# 실거래 테스트 DB 생성
createdb letrade_live_test_db

# 스키마 초기화
python -c "from src.common.database import init_database; init_database()"
```

### 2단계: 사전 검사 실행
```bash
# 안전성 검사 스크립트 실행
python scripts/live_test.py --pre-check-only

# 모든 검사 항목 PASS 확인 필수
```

### 3단계: 실거래 테스트 시작
```bash
# ⚠️ 경고: 실제 돈이 사용됩니다
python scripts/live_test.py

# 확인 메시지에서 정확히 입력:
# 1. "yes" - 테스트 시작 동의
# 2. "START" - 최종 실행 확인
```

---

## 📊 모니터링 및 제어

### 실시간 모니터링
- **대시보드**: http://localhost:8080/health
- **메트릭**: http://localhost:8000/metrics  
- **로그**: `tail -f logs/live_test_execution.log`
- **텔레그램**: 실시간 알림 수신

### 긴급 정지 방법
```bash
# 방법 1: 키보드 인터럽트
Ctrl+C

# 방법 2: 텔레그램 명령
/emergency_stop

# 방법 3: 시그널 전송
kill -TERM <process_id>

# 방법 4: API 호출
curl -X POST http://localhost:8080/emergency_stop
```

### 알림 임계값
- ✅ **거래 성공**: 모든 거래 기록
- ⚠️ **포지션 개시**: 포지션 오픈 알림
- 🔄 **포지션 종료**: 포지션 클로즈 알림  
- 🚨 **손실 경고**: $0.25 손실시 알림
- ❌ **리스크 위반**: 한도 초과시 즉시 알림

---

## 🎯 성공 기준

### 기술적 성공 기준
- [ ] **시스템 안정성**: 2시간 이상 무중단 실행
- [ ] **레이턴시**: 평균 5ms 이하 유지
- [ ] **오류율**: 1% 이하 유지
- [ ] **리스크 준수**: 모든 한도 내에서 운영

### 재무적 성공 기준  
- [ ] **손실 제한**: 총 손실 $1 이하
- [ ] **거래 실행**: 최소 3회 성공적 거래
- [ ] **리스크 관리**: 스톱로스 정상 작동
- [ ] **수익성**: 손익분기점 이상 (선택사항)

---

## 🚨 비상 상황 대응

### 자동 정지 트리거
1. **포트폴리오 손실** ≥ 5% ($5)
2. **연속 오류** ≥ 5회
3. **시스템 메모리** ≥ 90%
4. **API 응답 시간** ≥ 10초
5. **연속 손실 거래** ≥ 3회

### 수동 개입 필요 상황
- 거래소 API 장애
- 네트워크 연결 불안정
- 예상치 못한 급격한 가격 변동
- 시스템 리소스 고갈

### 긴급 연락처
- **시스템 관리자**: [연락처 입력]
- **Binance 지원**: support@binance.com
- **기술 지원**: [기술팀 연락처]

---

## 📄 테스트 완료 후

### 결과 분석
1. **최종 리포트**: `reports/live_test_report_*.md` 검토
2. **거래 내역**: 모든 거래 기록 분석
3. **성능 메트릭**: 레이턴시/처리량 분석
4. **리스크 평가**: 실제 vs 예상 리스크 비교

### 개선 사항 식별
- 성능 병목점 분석
- 리스크 매개변수 최적화
- 알림 시스템 개선
- 사용자 경험 향상

### 다음 단계 준비
- 자본 확대 계획 (성공시)
- 추가 전략 테스트 (성공시)  
- 시스템 개선 사항 적용
- 프로덕션 환경 준비

---

## ⚖️ 법적 고지사항

> **면책 조항**: 이 소프트웨어는 교육 및 테스트 목적으로만 제공됩니다. 실제 거래에서 발생하는 모든 손실에 대해 개발자는 책임을 지지 않습니다. 자신의 책임 하에 사용하시기 바랍니다.

> **투자 경고**: 암호화폐 거래는 높은 위험을 수반합니다. 투자 전 충분한 조사와 위험 평가를 수행하시기 바랍니다.

---

**마지막 업데이트**: 2025-06-24  
**버전**: 1.0.0  
**담당자**: Letrade_v1 개발팀